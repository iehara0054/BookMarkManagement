# モーダル作成ガイド

全画面（フルスクリーン）ブラウザ環境において、その機能の一部をモーダル（ダイアログ）として表示するには、HTML5の`<dialog>`要素とCSS、JavaScriptのFullscreen APIを組み合わせるのが最も現代的で推奨される方法です。

これにより、ツールバーなどのブラウザUIが隠れた状態でも、ユーザーの注目を特定の機能へ集めることができます。

## 実装のポイント

- **`<dialog>`要素の使用**: アクセシビリティが高く、モーダル機能（背景の無効化など）が標準で備わっています。
- **`::backdrop`疑似要素**: モーダルの背景を暗くしたり、ぼかしたりして、コンテンツを目立たせます。
- **`z-index`の管理**: 確実に全画面の最前面に表示されるようにします。

## 実装コード例

### 1. HTML

bodyタグの中にdialog要素を配置します。

```html
<button id="openModal">機能を開く</button>

<!-- モーダルダイアログ -->
<dialog id="myModal">
  <div class="modal-content">
    <h2>機能パネル</h2>
    <p>全画面ブラウザの一部機能を表示しています。</p>
    <button id="closeModal">閉じる</button>
  </div>
</dialog>
```

### 2. CSS

dialogが全画面の最前面に表示されるようにスタイルを設定します。

```css
dialog {
  border: none;
  border-radius: 8px;
  padding: 20px;
  width: 80%; /* 必要に応じて調整 */
  max-width: 500px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.3);
}

/* モーダルの背景（backdrop）を暗くする */
dialog::backdrop {
  background-color: rgba(0, 0, 0, 0.5);
}

/* フルスクリーンモード時のダイアログ表示用 */
dialog:modal {
  /* :modal疑似クラスで、ダイアログが開いている時のスタイルを定義 */
}
```

### 3. JavaScript

ダイアログの表示・非表示を制御します。

```javascript
const modal = document.getElementById('myModal');
const openBtn = document.getElementById('openModal');
const closeBtn = document.getElementById('closeModal');

// モーダルを開く
openBtn.addEventListener('click', () => {
  modal.showModal(); // showModal() を使うと背景が無効化される
});

// モーダルを閉じる
closeBtn.addEventListener('click', () => {
  modal.close();
});

// モーダルの背景クリックで閉じる
modal.addEventListener('click', (e) => {
  if (e.target === modal) {
    modal.close();
  }
});
```

## 全画面ブラウザの切り替え（参考）

ページ全体をフルスクリーンにするには、以下のようにFullscreen APIを使用します。

```javascript
function enterFullscreen() {
  const elem = document.documentElement;
  if (elem.requestFullscreen) {
    elem.requestFullscreen();
  }
}
```

## 注意点

- **iOS Safari**: フルスクリーンモード（Add to Home ScreenしたPWA）とWebブラウザでの表示において、モーダルの挙動が異なる場合があります。
- **閉じる方法**: ユーザーがEscキーを押した時にもモーダルが閉じることを保証してください（`<dialog>`要素の標準動作）。
